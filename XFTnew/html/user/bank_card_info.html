<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="../../css/mui.min.css" rel="stylesheet" />
		<link href="../../css/public.css" rel="stylesheet"/>
	</head>
    <style>
    	body,html{font-family: "微软雅黑";background-color: #272C33;}
    	.mui-content{padding: 0 7px;background-color: #272C33;}
    	.card{border-radius: 5px;margin-top: 12px;font-family: "微软雅黑";}
    	.card_content{margin: 0;color: #222222;}
    	.card div img{
    		width: 36px;
		    float: left;
		    margin-right: 17px;
		    background: #fff;
		    border-radius: 50%;
		    padding: 7px;
    	}
        .card_content{padding: 17px 6px;}
        .bank_xx{padding-left: 16.5%;}
        .bank_xx span{color: #FFFFFF;display: block;line-height: 17px;margin-bottom: 8px;}
        p{color: #FFFFFF;font-size: 1.7rem;margin: 0;}  
        #header{box-shadow: none;background-color: #272C33;} 
        .zh_yh{background: #C65055;} 
        .js_yh{background: #1A65A3;}
        .gs_yh{background: #C65055;} 
        .jt_yh{background: #1A65A3;} 
        .ny_yh{background: #249180;} 
        .yz_yh{background: #249180;} 
        .gd_yh{background: #7D0EA3;}
        .cs_yh{background: #C65055;}
        .pf_yh{background: #1A65A3;}
        .zx_yh{background: #C65055;}
        .hx_yh{background: #C65055;}
        .ms_yh{background: #249180;}
        .gf_yh{background: #C65055;}
        .xy_yh{background: #1A65A3;}
        .pa_yh{background: #C65055;}
        .other_yh{background: #D8B40B;}
        /*.mui-scroll-wrapper{position: inherit;}*/
       .mui-table-view-cell{background: url(../../images/add-card-img@3x.png)no-repeat;background-size: 1rem;
       color: #fff;background-position-y: center;padding-left: 2.5rem;background-position-x: 1.5rem;margin-top: 14px;}
       .mui-table-view:after,.mui-table-view:before{height: 0;}
       .mui-table-view{background-color: #383c42;margin-bottom: 50px;}
       .mui-scroll-wrapper{overflow: inherit;}
    </style> 
	<body>
		<header id="header" class="mui-bar mui-bar-nav">			
			<h1 class="mui-title" style="color: #FFFDFD;">银行卡</h1>
			<button style="color: #FFFDFD;" class="mui-action-back mui-btn mui-btn-blue mui-btn-link mui-btn-nav mui-pull-left">
				<span class="mui-icon mui-icon-left-nav"></span>返回
			</button>
		</header>
		<div class="mui-content">
			<div class="list-t-wrap">
			    <div id="pullrefresh" class="mui-scroll-wrapper">
			        <div class="mui-scroll">
			            <div class="list-wrapper">
			                <!--列表一定要放到容器内,因为会有一个div append到mui-scroll中,需要在底部才能起作用-->
			           		
			            </div>
			            <ul id="add-bank" class="mui-table-view">
						    <li class="mui-table-view-cell">
						        <a class="mui-navigate-right" style="background-color: inherit;">
						        	添加信用卡
						        </a>
						    </li>							    
						</ul>
			        </div>
			    </div>
			</div>
			<!--<div class="card zh_yh">
				<div class="card_content" style="">
					<img src="../../images/china@3x.png">
					
					<div class="bank_xx">
						<span id="my_bank" style="font-size: 18px;">中国银行</span>
						<span style="font-size: 12px;margin-bottom: 16px;">储蓄卡</span>
						<p id="card_id">**** **** **** 8888</p>
					</div>
				</div>				
			</div>
			<div class="card js_yh">
				<div class="card_content" style="">
					<img src="../../images/js@3x.png">
					
					<div class="bank_xx">
						<span id="my_bank" style="font-size: 18px;">建设银行</span>
						<span style="font-size: 12px;margin-bottom: 16px;">储蓄卡</span>
						<p id="card_id">**** **** **** 8888</p>
					</div>
				</div>				
			</div>
			<div class="card gs_yh">
				<div class="card_content" style="">
					<img src="../../images/gs@3x.png" style="padding: 0;">
					<div class="bank_xx">
						<span id="my_bank" style="font-size: 18px;">工商银行</span>
						<span style="font-size: 12px;margin-bottom: 16px;">储蓄卡</span>
						<p id="card_id">**** **** **** 8888</p>
					</div>
				</div>				
			</div>
			<div class="card jt_yh">
				<div class="card_content" style="">
					<img src="../../images/jt@3x.png" style="padding: 0;">
					<div class="bank_xx">
						<span id="my_bank" style="font-size: 18px;">交通银行</span>
						<span style="font-size: 12px;margin-bottom: 16px;">储蓄卡</span>
						<p id="card_id">**** **** **** 8888</p>
					</div>
				</div>				
			</div>
			<div class="card ny_yh">
				<div class="card_content" style="">
					<img src="../../images/ny@3x.png">
					<div class="bank_xx">
						<span id="my_bank" style="font-size: 18px;">农业银行</span>
						<span style="font-size: 12px;margin-bottom: 16px;">储蓄卡</span>
						<p id="card_id">**** **** **** 8888</p>
					</div>
				</div>				
			</div>
			<div class="card yz_yh">
				<div class="card_content" style="">
					<img src="../../images/yz@3x.png" style="padding: 0;">
					<div class="bank_xx">
						<span id="my_bank" style="font-size: 18px;">邮政银行</span>
						<span style="font-size: 12px;margin-bottom: 16px;">储蓄卡</span>
						<p id="card_id">**** **** **** 8888</p>
					</div>
				</div>				
			</div>
			<div class="card gd_yz">
				<div class="card_content" style="">
					<img src="../../images/gd@3x.png" style="padding: 0;">
					<div class="bank_xx">
						<span id="my_bank" style="font-size: 18px;">光大银行</span>
						<span style="font-size: 12px;margin-bottom: 16px;">储蓄卡</span>
						<p id="card_id">**** **** **** 8888</p>
					</div>
				</div>				
			</div>
			<div class="card cs_yh">
				<div class="card_content" style="">
					<img src="../../images/cs@3x.png">
					<div class="bank_xx">
						<span id="my_bank" style="font-size: 18px;">招商银行</span>
						<span style="font-size: 12px;margin-bottom: 16px;">储蓄卡</span>
						<p id="card_id">**** **** **** 8888</p>
					</div>
				</div>				
			</div>
			<div class="card pf_yh">
				<div class="card_content" style="">
					<img src="../../images/pf@3x.png" style="padding: 0;">
					<div class="bank_xx">
						<span id="my_bank" style="font-size: 18px;">浦发银行</span>
						<span style="font-size: 12px;margin-bottom: 16px;">储蓄卡</span>
						<p id="card_id">**** **** **** 8888</p>
					</div>
				</div>				
			</div>
			<div class="card zx_yh">
				<div class="card_content" style="">
					<img src="../../images/zx@3x.png" style="padding: 0;">
					<div class="bank_xx">
						<span id="my_bank" style="font-size: 18px;">中信银行</span>
						<span style="font-size: 12px;margin-bottom: 16px;">储蓄卡</span>
						<p id="card_id">**** **** **** 8888</p>
					</div>
				</div>				
			</div>
			<div class="card hx_yh">
				<div class="card_content" style="">
					<img src="../../images/hx@3x.png" style="padding: 0;">
					<div class="bank_xx">
						<span id="my_bank" style="font-size: 18px;">华夏银行</span>
						<span style="font-size: 12px;margin-bottom: 16px;">储蓄卡</span>
						<p id="card_id">**** **** **** 8888</p>
					</div>
				</div>				
			</div>
			<div class="card ms_yh">
				<div class="card_content" style="">
					<img src="../../images/ms@3x.png" style="padding: 0;">
					<div class="bank_xx">
						<span id="my_bank" style="font-size: 18px;">民生银行</span>
						<span style="font-size: 12px;margin-bottom: 16px;">储蓄卡</span>
						<p id="card_id">**** **** **** 8888</p>
					</div>
				</div>				
			</div>
			<div class="card gf_yh">
				<div class="card_content" style="">
					<img src="../../images/gf@3x.png" style="padding: 0;">
					<div class="bank_xx">
						<span id="my_bank" style="font-size: 18px;">广发银行</span>
						<span style="font-size: 12px;margin-bottom: 16px;">储蓄卡</span>
						<p id="card_id">**** **** **** 8888</p>
					</div>
				</div>				
			</div>
			<div class="card xy_yh">
				<div class="card_content" style="">
					<img src="../../images/xy@3x.png" style="padding: 0;">
					<div class="bank_xx">
						<span id="my_bank" style="font-size: 18px;">兴业银行</span>
						<span style="font-size: 12px;margin-bottom: 16px;">储蓄卡</span>
						<p id="card_id">**** **** **** 8888</p>
					</div>
				</div>				
			</div>
			<div class="card pa_yh">
				<div class="card_content" style="">
					<img src="../../images/pa@3x.png" style="padding: 0;">
					<div class="bank_xx">
						<span id="my_bank" style="font-size: 18px;">平安银行</span>
						<span style="font-size: 12px;margin-bottom: 16px;">储蓄卡</span>
						<p id="card_id">**** **** **** 8888</p>
					</div>
				</div>				
			</div>
			<div class="card other_yh">
				<div class="card_content" style="">
					<img src="../../images/other-bank@3x.png">
					<div class="bank_xx">
						<span id="my_bank" style="font-size: 18px;">其他银行</span>
						<span style="font-size: 12px;margin-bottom: 16px;">储蓄卡</span>
						<p id="card_id">**** **** **** 8888</p>
					</div>
				</div>				
			</div>-->
		</div>
		<script src="../../js/mui.min.js"></script>
		<script type="text/javascript" src="../../js/immersed.js" ></script>
		<script type="text/javascript" src="../../js/jquery-1.8.0.min.js" ></script>
		<script type="text/javascript">
			mui.plusReady(function(){
				mui.init({  
					pullRefresh: 
				    {
				      container: '#pullrefresh',
				      down: {
				      	height: 50, //可选,默认50.触发下拉刷新拖动距离,
						auto: false, //可选,默认false.自动下拉刷新一次
						contentdown: "", //可选，在下拉可刷新状态时，下拉刷新控件上显示的标题内容
						contentover: "释放立即回弹", //可选，在释放可刷新状态时，下拉刷新控件上显示的标题内容
						contentrefresh: "", //可选，正在刷新状态时，下拉刷新控件上显示的标题内容
				        callback: pulldownRefresh
				      },//http://www.cnblogs.com/CyLee/p/5324224.html				      
				   	},
					hardwareAccelerated:true, //开启硬件加速	
					
				}); 
				function pulldownRefresh() {
					setTimeout(function() {
//					alert(&quot;shuaxin&quot;);
					mui('#pullrefresh').pullRefresh().endPulldownToRefresh();
					})
				}
				// 创建加载内容窗口
				var topoffset='45px';
				if(plus.navigator.isImmersedStatusbar()){// 兼容immersed状态栏模式
					topoffset=(Math.round(plus.navigator.getStatusbarHeight())+45)+'px';
				} 
				document.getElementById('header').style.height=(immersed+44)+'px';
//				document.querySelector('.mui-content').style.marginTop=(immersed)+'px';
				if(mui.os.ios){
					document.querySelector('.mui-content').style.marginTop=(immersed)+'px';
					document.querySelector('.mui-scroll').style.marginTop=(immersed+45)+'px';
				}else if(mui.os.android){
					document.querySelector('#pullrefresh').style.marginTop=(immersed)+'px';
					document.querySelector('.mui-scroll-wrapper').style.position='inherit';
				}
				
				window.addEventListener('bank_info_load',function(event){					
					location.reload();
				});
				
				var uid=plus.storage.getItem('uid');
				var token=plus.storage.getItem('token');	
				mui.ajax('http://www.zhxft.com/app/index1/my_savings_bank',{
					async:false,
					data:{
						uid:uid,
						token:token,					
					},
					dataType:'JSON',//服务器返回json格式数据
					type:'post',//HTTP请求类型
					success:function(data){
						console.log(data);
						var arrParse = JSON.parse(data);
						if(arrParse.info.code==6){
							plus.storage.clear();
							plus.storage.setItem("launchFlag", "林允");
							mui.confirm('你当前并未登录(或账号在其他手机登录以致此手机账号被退出)，是否前往登录！','提示',['是','否'],function(e){
								if(e.index==0){
									mui.openWindow({
										url: '../index/login.html',
										id: 'login',
										show: {
											autoShow:false,
											aniShow: 'pop-in',
											duration:'350',
										}//额外扩展参数
										,createNew:true,extras:{type:1},//是否重复创建同样id的webview，默认为false:不重复创建，直接显示
										styles:{softinputMode:'adjustResize'},
										waiting: {
											autoShow: true
										}
									});
								}
							},'div')
							return;
						}
						var list=document.querySelector('.list-wrapper');
						list.innerHTML='';
						var str = arrParse.account;
						var type=arrParse.state;
						var style='';
						var bank;
						if(arrParse.account_state==0){
							mui.alert('你当前尚未绑定银行卡','提示','','','div');
							return;
						}
						switch (type)
						{						
							case 1:
							  bank='pa_yh';
							  style='padding: 0';								  
							  break;
							case 2:
							  bank='ny_yh';
							  break;
							case 3:
							  bank='cs_yh';
							  style='padding: 0';
							  break;
							case 4:
							  bank='zh_yh';
							  break;
							case 5:
							  bank='gs_yh';
							  style='padding: 0';
							  break;
							case 6:
							  bank='js_yh';
							  style='padding: 0';
							  break;
							case 7:
							  bank='gd_yh';
							  style='padding: 0';
							  break; 
							case 8:
							  bank='gf_yh';
							  style='padding: 0';
							  break; 
							case 9:
							  bank='hx_yh';
							  style='padding: 0';
							  break;
							case 10:
							  bank='jt_yh';
							  style='padding: 0';
							  break;  
							case 11:
							  bank='ms_yh';
							  style='padding: 0';
							  break; 
							case 12:
							  bank='pf_yh';
							  style='padding: 0';
							  break;
							case 13:
							  bank='xy_yh';
							  style='padding: 0';
							  break;
							case 14:
							  bank='yz_yh';
							  style='padding: 0';
							  break;
							case 15:
							  bank='zx_yh';
							  style='padding: 0';
							  break;
							case 16:
							  bank='other_yh';
							  style='padding: 0';
							  break;
						}
						list.innerHTML+='<div class="card '+bank+'"  title="1"><div class="card_content" style="">'
							+'<img src="'+arrParse.img+'" style="'+style+'">'					
							+'<div class="bank_xx" title="'+str+'">'
								+'<span id="my_bank" style="font-size: 18px;">'+arrParse.bank_name+'</span>'
								+'<span style="font-size: 12px;margin-bottom: 16px;">储蓄卡</span>'
								+'<p id="card_id">**** **** **** '+str+'</p>'
							+'</div>'
						+'</div></div>';
						for (var i=0;i<arrParse.data.length;i++) {
							switch (arrParse.data[i].state_s)
							{						
								case 1:
								  bank='pa_yh';
								  style='padding: 0';								  
								  break;
								case 2:
								  bank='ny_yh';
								  break;
								case 3:
								  bank='cs_yh';
								  style='padding: 0';
								  break;
								case 4:
								  bank='zh_yh';
								  break;
								case 5:
								  bank='gs_yh';
								  style='padding: 0';
								  break;
								case 6:
								  bank='js_yh';
								  style='padding: 0';
								  break;
								case 7:
								  bank='gd_yh';
								  style='padding: 0';
								  break; 
								case 8:
								  bank='gf_yh';
								  style='padding: 0';
								  break; 
								case 9:
								  bank='hx_yh';
								  style='padding: 0';
								  break;
								case 10:
								  bank='jt_yh';
								  style='padding: 0';
								  break;  
								case 11:
								  bank='ms_yh';
								  style='padding: 0';
								  break; 
								case 12:
								  bank='pf_yh';
								  style='padding: 0';
								  break;
								case 13:
								  bank='xy_yh';
								  style='padding: 0';
								  break;
								case 14:
								  bank='yz_yh';
								  style='padding: 0';
								  break;
								case 15:
								  bank='zx_yh';
								  style='padding: 0';
								  break;
								case 16:
								  bank='other_yh';
								  style='padding: 0';
								  break;
							}
							list.innerHTML+='<div class="card '+bank+'" id="'+arrParse.data[i].id+'" title="2"><div class="card_content" style="">'
								+'<img src="'+arrParse.data[i].img+'" style="'+style+'">'					
								+'<div class="bank_xx" title="'+arrParse.data[i].cardNumber+'">'
									+'<span id="my_bank" style="font-size: 18px;">'+arrParse.data[i].bank_name+'</span>'
									+'<span style="font-size: 12px;margin-bottom: 16px;">信用卡</span>'
									+'<p id="card_id">**** **** **** '+arrParse.data[i].cardNumber+'</p>'
								+'</div>'
							+'</div></div>';							
						}
					},
					error:function(xhr,error,errorThrown){
						console.log(error);
					}
				});
				
				mui('.list-wrapper').on('tap','.card',function(){
					var i=$(this).attr('title');
					if(i==1){
						
					}else if(i==2){}
					var id=$(this).attr('id');
					var bank=$(this).children().children('.bank_xx').attr('title');
					mui.openWindow({
						url: 'credit_card.html',
						id: 'credit_card',
						show: {
							autoShow:false,
							aniShow: 'pop-in',
							duration:'350',
						},extras:{bank_id:id,bank:bank,bank_type:i},
						styles:{
//								bounce: 'vertical',bounceBackground:'#fc1',
							},
						waiting: {
							autoShow: true
						}
					});
				});
				
				document.getElementById('add-bank').addEventListener('tap',function(){
					mui.openWindow({
						url: 'user_bind_card.html',
						id: 'user_bind_card',
						show: {
							autoShow:false,
							aniShow: 'pop-in',
							duration:'350',
						},
//						extras:{bank_id:id,bank:bank,bank_type:i},
						waiting: {
							autoShow: true
						}
					});
				})
				
				window.addEventListener('card_move',function(event){
					var id = event.detail.card_id;
					$('#'+id+'').remove();
				});
				
				//关闭页面跳转动画
				plus.nativeUI.closeWaiting();
				//显示当前页面
				var self = plus.webview.currentWebview();
				self.show('pop-in',350);
			});
		</script>
	</body>

</html>